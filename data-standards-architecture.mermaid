flowchart LR

%% =========================
%% Domain Data Layer
%% =========================
subgraph L1["Domain Data Sources (Decentralized)"]
    RDBMS[(Operational Databases)]
    LAKE[(Data Lake Tables)]
    WH[(Analytical Warehouses)]
    STREAM[(Streams & Events)]
    APIS[(APIs & Services)]
end

%% =========================
%% Metadata Extraction
%% =========================
subgraph L2["Automated Metadata & Model Extraction"]
    SCHEMA[Schema & Structure\nExtractors]
    PIPE[Pipeline & Query\nParsers]
    LINEAGE[Lineage & Provenance\nCollectors]
end

%% =========================
%% Canonical Modeling
%% =========================
subgraph L3["Canonical Modeling & Normalization"]
    PHYS2LOG[Physical → Logical\nModel Mapping]
    SEMANTIC[Semantic Layer &\nBusiness Glossary]
    SERIAL[DCAT / DPROD\nSerialization RDF / JSON-LD]
end

%% =========================
%% Governance & Policy
%% =========================
subgraph L4["Governance, Policy & Contracts"]
    ODRL[Usage & Access Policies\n ODRL]
    CONTRACTS[Data Contracts\nSchema • SLA • SLO]
    OWNERS[Ownership & Stewardship]
end

%% =========================
%% Validation
%% =========================
subgraph L5["Validation & Certification"]
    SHACL[Standards Validation\n DCAT / DPROD / ODRL]
    RULES[Completeness &\nQuality Rules]
end

%% =========================
%% Metadata Graph
%% =========================
subgraph L6["Metadata Graph Backbone"]
    KG[(Knowledge / Metadata Graph)]
    PROV[Lineage & Provenance\n PROV-O]
end

%% =========================
%% Consumption
%% =========================
subgraph L7["Publishing & Consumption"]
    CATALOG[Central Data Catalog]
    DISCOVERY[Search & Discovery]
    ACCESS[Policy-Aware\nAccess Workflows]
    METAAPI[Metadata APIs]
end

%% =========================
%% Flows
%% =========================
RDBMS --> SCHEMA
LAKE --> SCHEMA
WH --> SCHEMA
STREAM --> SCHEMA
APIS --> SCHEMA

RDBMS --> PIPE
LAKE --> PIPE
WH --> PIPE

PIPE --> LINEAGE
LINEAGE --> PHYS2LOG
SCHEMA --> PHYS2LOG

PHYS2LOG --> SEMANTIC
SEMANTIC --> SERIAL

SERIAL --> ODRL
SERIAL --> CONTRACTS
SERIAL --> OWNERS

ODRL --> SHACL
CONTRACTS --> SHACL
OWNERS --> SHACL
SHACL --> RULES

RULES --> KG
LINEAGE --> PROV
PROV --> KG

KG --> CATALOG
KG --> DISCOVERY
KG --> ACCESS
KG --> METAAPI
