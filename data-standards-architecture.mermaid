flowchart LR

%% =======================
%% Domain Layer
%% =======================
subgraph Domain["Domain Data Sources (Decentralized)"]
    DB[(Operational Databases)]
    DL[(Data Lake Tables)]
    DW[(Data Warehouse)]
    ST[(Streaming & Events)]
    API[(APIs & Services)]
end

%% =======================
%% Extraction Layer
%% =======================
subgraph Extract["Metadata & Model Extraction"]
    SCHEMA[Schema & Structure\nExtractors]
    PIPE[Pipeline & Query\nParsers]
    LINEAGE[Lineage & Provenance\nCollectors]
end

%% =======================
%% Normalization Layer
%% =======================
subgraph Normalize["Canonical Modeling & Normalization"]
    LOGICAL[Logical & Semantic\nModel Mapping]
    GLOSSARY[Business Glossary\nAlignment]
    SERIALIZE[Metadata Serialization\n]
end

%% =======================
%% Governance Layer
%% =======================
subgraph Govern["Governance, Policy & Contracts"]
    ODRL[Usage Policies\n]
    CONTRACTS[Data Contracts\n]
    OWNERS[Ownership & Stewardship]
end

%% =======================
%% Validation Layer
%% =======================
subgraph Validate["Validation & Certification"]
    SHACL[Standards Validation\n]
    RULES[Quality & Completeness\nRules]
end

%% =======================
%% Graph Backbone
%% =======================
subgraph Graph["Metadata Graph Backbone"]
    KG[(Knowledge / Metadata Graph)]
    PROV[Provenance & Lineage\n]
end

%% =======================
%% Consumption Layer
%% =======================
subgraph Consume["Publishing & Consumption"]
    CATALOG[Central Data Catalog]
    SEARCH[Discovery & Search]
    ACCESS[Policy-Aware\nAccess Workflows]
    APIS[Metadata APIs]
end

%% =======================
%% Flows
%% =======================
DB --> SCHEMA
DL --> SCHEMA
DW --> SCHEMA
ST --> SCHEMA
API --> SCHEMA

DB --> PIPE
DL --> PIPE
DW --> PIPE

SCHEMA --> LOGICAL
PIPE --> LINEAGE
LINEAGE --> LOGICAL

LOGICAL --> GLOSSARY
GLOSSARY --> SERIALIZE

SERIALIZE --> ODRL
SERIALIZE --> CONTRACTS
SERIALIZE --> OWNERS

ODRL --> SHACL
CONTRACTS --> SHACL
OWNERS --> SHACL
SHACL --> RULES

RULES --> KG
LINEAGE --> PROV
PROV --> KG

KG --> CATALOG
KG --> SEARCH
KG --> ACCESS
KG --> APIS
